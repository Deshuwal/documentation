!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-recaptcha3",["exports","@angular/common","@angular/core","@angular/forms","rxjs","rxjs/operators"],t):t((e=e||self)["angular-recaptcha3"]={},e.ng.common,e.ng.core,e.ng.forms,e.rxjs,e.rxjs.operators)}(this,(function(e,t,i,n,o,r){"use strict";var a=new i.InjectionToken("RECAPTCHA_OPTION"),s=function(){function e(e){var t=this;this.scriptLoaded=!1,this.readySubject=new o.BehaviorSubject(!1),"undefined"!=typeof window&&(window.reCaptchaOnloadCallback=function(){e.run(t.onloadCallback.bind(t))})}return e.prototype.getReady=function(e){if(!this.scriptLoaded){this.scriptLoaded=!0;var t=document.body,i=document.createElement("script");i.innerHTML="",i.src="https://www.google.com/recaptcha/api.js?onload=reCaptchaOnloadCallback&render=explicit"+(e?"&hl="+e:""),i.async=!0,i.defer=!0,t.appendChild(i)}return this.readySubject.asObservable()},e.prototype.execute=function(e){void 0===e&&(e=void 0);var t=window.grecaptcha,i=document.querySelector(".g-recaptcha.invisible");return t.execute(i.id,e)},e.prototype.onloadCallback=function(){this.readySubject.next(!0)},e}();function p(e,t){return t||new s(e)}s.decorators=[{type:i.Injectable}],s.ctorParameters=function(){return[{type:i.NgZone}]};var c={provide:s,deps:[i.NgZone,[new i.Optional,new i.SkipSelf,s]],useFactory:p},h=function(){function e(e,t,n){this._zone=e,this._captchaService=t,this.option=n,this.hide=!0,this.captchaResponse=new i.EventEmitter,this.captchaExpired=new i.EventEmitter,this.widgetId=null,this.ngUnsubscribe=new o.Subject,this.onChange=function(){},this.onTouched=function(){},n=n||{language:"ru",invisible:{sitekey:this.sitekey||void 0,theme:"light",type:"image",tabindex:0,badge:"bottomright"}}}return e.prototype.ngAfterViewInit=function(){this.setWidgetId()},e.prototype.reset=function(){null!==this.widgetId&&(this.grecaptchaReset(),this.onChange(null))},e.prototype.setWidgetId=function(){var e=this;this._captchaService.getReady(this.language||this.option.language).pipe(r.takeUntil(this.ngUnsubscribe)).subscribe((function(t){t&&(e.widgetId=e.render(e.targetRef.nativeElement))}))},e.prototype.render=function(e){var t=this;return window.grecaptcha.render(e,{sitekey:this.getSiteKey(),badge:this.getBadge(),theme:this.getTheme(),type:this.getType(),tabindex:this.getTabindex(),size:this.size||"invisible",callback:function(e){return t._zone.run(t.recaptchaCallback.bind(t,e))},"expired-callback":function(){return t._zone.run(t.recaptchaExpiredCallback.bind(t))}})},e.prototype.execute=function(e){if(void 0===e&&(e=void 0),"invisible"===this.size){if(null===this.widgetId)throw new Error("Invalid widgetId");return window.grecaptcha.execute(this.widgetId,e)}},e.prototype.getResponse=function(){if(null===this.widgetId)throw new Error("Invalid widgetId");return window.grecaptcha.getResponse(this.widgetId)},e.prototype.writeValue=function(e){},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.ngOnDestroy=function(){this.grecaptchaReset(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},e.prototype.recaptchaCallback=function(e){this.onChange(e),this.onTouched(),this.captchaResponse.emit(e)},e.prototype.recaptchaExpiredCallback=function(){this.onChange(null),this.onTouched(),this.captchaExpired.emit()},e.prototype.grecaptchaReset=function(){var e=this;null!=this.widgetId&&this._zone.runOutsideAngular((function(){return window.grecaptcha.reset(e.widgetId)}))},e.prototype.getSiteKey=function(){if(this.sitekey)return this.sitekey;if("invisible"===this.size)return this.option.invisible.sitekey;if("normal"===this.size)return this.option.normal.sitekey;throw new Error("Invalid sitekey")},e.prototype.getBadge=function(){return this.badge?this.badge:"invisible"===this.size?this.option.invisible.badge:"normal"===this.size?this.option.normal.badge:"bottomright"},e.prototype.getTheme=function(){return this.theme?this.theme:"invisible"===this.size?this.option.invisible.theme:"normal"===this.size?this.option.normal.theme:"light"},e.prototype.getType=function(){return this.type?this.type:"invisible"===this.size?this.option.invisible.type:"normal"===this.size?this.option.normal.type:"image"},e.prototype.getTabindex=function(){return this.tabindex?this.tabindex:"invisible"===this.size?this.option.invisible.tabindex:"normal"===this.size?this.option.normal.tabindex:0},e}();h.decorators=[{type:i.Component,args:[{selector:"recaptcha",template:"\n        <div #target\n            [ngClass]=\"{'hide': hide}\"\n            [class]=\"'recaptcha g-recaptcha ' + (size || 'invisible')\"\n            [id]=\"widgetId\">\n        </div>\n    ",providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:i.forwardRef((function(){return h})),multi:!0}],styles:["\n        .hide {\n            display: none;\n        }\n    "]}]},{type:i.Injectable}],h.ctorParameters=function(){return[{type:i.NgZone},{type:s},{type:void 0,decorators:[{type:i.Inject,args:[a]}]}]},h.propDecorators={sitekey:[{type:i.Input}],size:[{type:i.Input}],theme:[{type:i.Input}],type:[{type:i.Input}],tabindex:[{type:i.Input}],badge:[{type:i.Input}],language:[{type:i.Input}],hide:[{type:i.Input}],captchaResponse:[{type:i.Output}],captchaExpired:[{type:i.Output}],targetRef:[{type:i.ViewChild,args:["target"]}]};var u=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t=void 0),{ngModule:e,providers:[{provide:a,useValue:t}]}},e}();u.decorators=[{type:i.NgModule,args:[{imports:[t.CommonModule],declarations:[h],exports:[h],providers:[c]}]}],e.RECAPTCHA_OPTION=a,e.RECAPTCHA_SERVICE_PROVIDER=c,e.RECAPTCHA_SERVICE_PROVIDER_FACTORY=p,e.ReCaptchaComponent=h,e.ReCaptchaModule=u,e.ReCaptchaService=s,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-recaptcha3.umd.min.js.map